System.register("chunks:///_virtual/audioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NameTs.ts"],(function(o){var i,n,e,u,a,t,c;return{setters:[function(o){i=o.createClass},function(o){n=o.cclegacy,e=o.AudioSource,u=o.resources,a=o.AudioClip,t=o.clamp01},function(o){c=o.default}],execute:function(){n._RF.push({},"d0c8cXCswxBi7u9eALa4YwA","audioManager",void 0);var s=o("audioManager",function(){function o(){this.SoundMap=new Map,this.isOpen=!1,this._volume=0}var n=o.prototype;return n.init=function(){o._audioSource=new e,o._audioSource2=new e},n.setAudioSourceClip=function(i){o._audioSource.clip=i},n.playMusic=function(i){void 0===i&&(i=!0);var n=o._audioSource;n.loop=i,n.volume=0,n.playOnAwake=!0;var e=c.Game_Music_BGM;n.clip?n.play():u.load(e,a,(function(o,i){o?console.warn("资源加载失败",o):(n.clip=i,console.log("播放背景音"),n.playing||n.play())}))},n.playSound=function(i,n){var e=this;void 0===n&&(n=1);var t=o._audioSource2,c=function(o){t.playOneShot(o,0==e._volume?0:n)};if(this.SoundMap.has(i)){var s=this.SoundMap.get(i);c(s)}else u.load(i,a,(function(o,n){o?console.warn("资源加载失败",o):(e.SoundMap.set(i,n),c(n))}))},n.setMusicVolume=function(i){this.isOpen=!0;var n=o._audioSource;i=t(i),n.volume=i,this._volume=i},i(o,null,[{key:"instance",get:function(){return this._instance||(this._instance=new o,this._instance.init()),this._instance}}]),o}());s._instance=void 0,s._audioSource=void 0,s._audioSource2=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/Constant.ts",["./rollupPluginModLoBabelHelpers.js","cc","./InterfaceTs.ts","./Util.ts"],(function(e){var r,t,i,n;return{setters:[function(e){r=e.createClass},function(e){t=e.cclegacy},function(e){i=e.GearType},function(e){n=e.default}],execute:function(){t._RF.push({},"4d78cuARzNE5YM3LaH6AVBq","Constant",void 0);var u=e("default",function(){function e(){}return r(e,null,[{key:"GearSpeedRate",get:function(){return 1==n.CustomId?2:4}}]),e}());u.GearUrlArr=["sprite/gear/gear","sprite/gear/gear1","sprite/gear/gear2","sprite/gear/gear3"],u.GirdUrlArr=["sprite/gird/gird","sprite/gird/gird1","sprite/gird/gird2"],u.GearLineUrl="sprite/line/line",u.NpcUrl="sprite/npc/",u.CustomGearArr=[[i.Blue,i.Blue,i.Blue2],[i.Blue,i.Blue2,i.Purple2]],u.AtkCd=.5,u.CreateNpcNum=[5,9999],t._RF.pop()}}}));

System.register("chunks:///_virtual/CreateGearTs.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,i;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,i=t.Component}],execute:function(){var o;n._RF.push({},"3e63aeB0UpFda2ifM0mKMLU","CreateGearTs",void 0);var a=r.ccclass;r.property,t("CreateGearTs",a("CreateGearTs")(o=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.onLoad=function(){this.initNode(),this.initEvent()},r.initNode=function(){},r.initEvent=function(){},r.start=function(){},r.update=function(t){},n}(i))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyBox.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NameTs.ts","./pool.ts","./Constant.ts","./Util.ts"],(function(t){var e,n,o,i,l,s,r,u,a,c,h,p,f,d,E;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){l=t.cclegacy,s=t._decorator,r=t.Node,u=t.find,a=t.director,c=t.instantiate,h=t.Component},function(t){p=t.default},function(t){f=t.default},function(t){d=t.default},function(t){E=t.default}],execute:function(){var _,y,m,b,N;l._RF.push({},"e5d9fnHW35K/peb73Vn6DXt","EnemyBox",void 0);var x=s.ccclass,B=s.property;t("EnemyBox",(_=x("EnemyBox"),y=B({displayName:"敌人预制体",type:r}),_((N=e((b=function(t){function e(){for(var e,n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return e=t.call.apply(t,[this].concat(l))||this,o(e,"bulletNode",N,i(e)),e.box=null,e._pos1=null,e._pos2=null,e.pool=null,e._index=0,e._createNum=0,e}n(e,t);var l=e.prototype;return l.onLoad=function(){this.initNode(),this.initEvent(),this.initPool()},l.initNode=function(){this.box=u("box",this.node),this._pos1=u("pos1",this.node).getPosition(),this._pos2=u("pos2",this.node).getPosition()},l.initEvent=function(){a.on(p.GAME_ENEMY_CREATE,this.createBullet,this),a.on(p.GAME_ENEMY_DESTORY,this.clearBullet,this),a.on(p.GAME_START,this.onStartGame,this)},l.onDestroy=function(){a.off(p.GAME_ENEMY_CREATE,this.createBullet,this),a.off(p.GAME_ENEMY_DESTORY,this.clearBullet,this)},l.initPool=function(){var t=c(this.bulletNode);this.pool=new f(t,10)},l.onStartGame=function(){var t=this,e=d.CreateNpcNum[E.CustomId-1];this.schedule((function(){E.AllStop||(t.createBullet({pos1:t._pos1.clone(),pos2:t._pos2,hp:100,atk:10}),e--,t._createNum++,e<=0&&t.unscheduleAllCallbacks())}),1)},l.ClearPool=function(){for(var t=this.box.children.length-1;t>=0;)this.clearBullet(this.box.children[0]),t--;this.unscheduleAllCallbacks()},l.createBullet=function(t){this._index+=1,t.index=this._index,this.pool.createEnemy(this.box,t)},l.clearBullet=function(t){this.pool.onEnemyKilled(t)},l.start=function(){},l.update=function(t){},e}(h)).prototype,"bulletNode",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameTs.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Util.ts","./UiTs.ts"],(function(n){var t,e,i,o,u,s,c,a;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,i=n._decorator,o=n.find,u=n.sys,s=n.Component},function(n){c=n.default},function(n){a=n.UiTs}],execute:function(){var r,d;e._RF.push({},"cfe47QKymJG0YZDE2epIs5L","GameTs",void 0);var l=i.ccclass;i.property,n("GameTs",l("GameTs")(((d=function(n){function e(){for(var t,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))||this)._nodeRound=null,t._uiTs=null,t}t(e,n);var i=e.prototype;return i.onLoad=function(){e.instance||(e.instance=this),this.initNode(),this.initEvent(),this.initLanguage()},i.initNode=function(){var n;this._nodeRound=o("GameBox/NodeRound",this.node),this._uiTs=null==(n=o("ui",this.node))?void 0:n.getComponent(a)},i.initEvent=function(){},i.onDestroy=function(){},i.initLanguage=function(){console.log(u.languageCode)},i.gameEnd=function(n){},i.onEnable=function(){var n=this;this.scheduleOnce((function(){n.SetMergeFormUi(!0)}),.5)},i.SetMergeFormUi=function(n){this._uiTs.SetMergeFormUi(n)},i.NextRound=function(){this._nodeRound.children.forEach((function(n,t){n.active=t==c.CustomId-1}))},i.start=function(){},i.update=function(n){},i.downBtn=function(){c.downGame()},e}(s)).instance=null,r=d))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/GearForm.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Util.ts","./ItemGearTs.ts","./InterfaceTs.ts","./NameTs.ts"],(function(e){var t,n,o,a,i,r,s,d,h,c,u,l,G,_,f,g,p,v,C,y,S;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,a=e.find,i=e.Widget,r=e.Layout,s=e.director,d=e.Node,h=e.UITransform,c=e.v3,u=e.v2,l=e.instantiate,G=e.tween,_=e.Tween,f=e.Component},function(e){g=e.default},function(e){p=e.ItemGearTs},function(e){v=e.GearType,C=e.GridType,y=e.GameStateEnum},function(e){S=e.default}],execute:function(){var T;n._RF.push({},"04a3c7yU+VC57n6119jlVId","GearForm",void 0);var m=o.ccclass;o.property,e("GearForm",m("GearForm")(T=function(e){function n(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._itemBg=null,t._nodeBgBox=null,t._nodeCreateBox=null,t._nodeCopy=null,t._copyTs=null,t._nodeBlock=null,t._wid=null,t._btnStart=null,t._nodeHand=null,t._nodeBtn=null,t._btnClick=null,t._createLayout=null,t._crashArr=[],t._guideId=0,t}t(n,e);var o=n.prototype;return o.onLoad=function(){this.initNode(),this.initEvent(),this.initMap()},o.initNode=function(){this._itemBg=a("ItemGear",this.node),this._nodeBgBox=a("NodeContent/NodeBox",this.node),this._nodeCreateBox=a("NodeContent/NodeCreateBox/Box",this.node),this._nodeCopy=a("NodeContent/NodeCopy",this.node),this._nodeBlock=a("NodeContent/NodeBlock",this.node),this._btnStart=a("NodeContent/BtnStart",this.node),this._nodeHand=a("NodeContent/NodeHand",this.node),this._wid=this.node.getComponent(i),this._createLayout=this._nodeCreateBox.getComponent(r),this._nodeBtn=a("NodeContent/NodeBtn",this.node),this._btnClick=a("nodeBtn",this._nodeBtn)},o.initEvent=function(){s.on(S.GAME_GEAR_TOUCH,this.onTouchStart,this),s.on(S.GAME_GEAR_MOVE,this.onTouchMove,this),s.on(S.GAME_GEAR_END,this.onTouchEnd,this),s.on(S.GAME_ANI_START,this.onAllStart,this),s.on(S.GAME_ANI_STOP,this.onAllStop,this),s.on(S.GAME_SHOW_CREATE,this.onCreateItemParticle,this),this._btnStart.on(d.EventType.TOUCH_END,this.onClickStart,this),this._btnClick.on(d.EventType.TOUCH_END,this.onClickCreate,this)},o.onTouchGearStart=function(){},o.onTouchStart=function(e){this._createLayout.alignHorizontal=!1,this._createLayout.alignHorizontal=!0,this._crashArr=[],this._createLayout.updateLayout();var t=e.GetGearData();t.lineId>0&&(t.x+=1),t.id>0&&(t.id=-1,t.lineId=-1,t.index=99),t.uid=e.node.uuid,0==this._nodeCopy.children.length?this._copyTs=this.onCreateGearItem(t,this._nodeCopy):this._copyTs.SetData(t),this._copyTs.node.active=!0,this._nodeCopy.active=!0,this._copyTs.node.setWorldPosition(e.node.getWorldPosition()),this.onCheckSameGear()},o.onTouchMove=function(e){if(e){var t=this._nodeCopy.getComponent(h).convertToNodeSpaceAR(c(e.x,e.y,0));this._copyTs.node.setPosition(t),this.onCheckGearTouch(),this.onCheckSameGear()}},o.onCheckSameGear=function(){var e=g.GetSameGear(this._copyTs);e.length>0&&this._guideId>1&&this._copyTs.SetLinePos(e)},o.onTouchEnd=function(){var e=this;this._createLayout.updateLayout(!0),this._copyTs.node.active=!1,this._copyTs.node.setPosition(c(window.screen.width,0,0));var t=this._copyTs.GetGearData(),n=t.gear;if(this._crashArr.length>0)if(t.index>-1){if((n==v.Blue2||n==v.Purple2||n==v.Red2)&&this._crashArr.length<2&&!(this._crashArr[0].GetGearData().index>-1))return void this.onCheckGearTouch();var o=null,a=null;t.lineId>-1&&(a=g.GetRoundGear(t.x,t.y,t.lineId>-1?3:1)),99==t.index&&(o=g.GetRoundGear(t.x,t.y,0),(t.lineId>-1||t.gear==v.Blue2||t.gear==v.Purple2||t.gear==v.Red2)&&(a=g.GetRoundGear(t.x,t.y,t.lineId>-1?3:1)));var i=this._crashArr[0].GetGearData(),r=i.gear;if(this._crashArr.length>1){if(g.IsGuide&&(i.x!==g.GuideTagetPos[0]||i.y!==g.GuideTagetPos[1]))return void this.onCheckGearTouch();var s=this._crashArr[1].GetGearData(),d=s.gear;if(i.x==t.x&&i.y==t.y||s.x==t.x&&s.y==t.y)return void this.onCheckGearTouch();var h=!1,u=!1;if(r==n&&d==n){var l=n+1;l<=v.Red2&&(n=l,i.gear=s.gear=1,i.lineId=s.lineId=-1,u=!0)}else(r>v.Gold||d>v.Gold)&&(r>v.Gold||d>v.Gold)&&(h=!0);o&&o.RestData(h?1:i.gear,h?-1:i.lineId),a&&a.RestData(h?1:s.gear,h?-1:s.lineId);var G=function(t){var n=e._crashArr[t],o=n.GetGearData(),a=o.gear;if(a>v.Gold)if(a>=v.Blue2){var i=o.lineId>0;if(0==t&&!i)g.GetRoundGear(o.x,o.y,1).RestData(1,-1);if(1==t&&i)g.GetRoundGear(o.x,o.y,3).RestData(1,-1);(1==t||!i&&0==t)&&!u&&e.onCreateSingleGear(a),n.RestData(1,-1)}else e.onCreateSingleGear(a)};G(0),G(1),this._crashArr[0].RestData(n,s.id),this._crashArr[1].RestData(n),u&&this._crashArr[1].ShowMerge()}else{if(g.IsGuide&&(i.x!==g.GuideTagetPos[0]||i.y!==g.GuideTagetPos[1]))return void this.onCheckGearTouch();if(i.x==t.x&&i.y==t.y&&i.id>-1)return void this.onCheckGearTouch();if((r==v.Blue2||r==v.Purple2||r==v.Red2)&&i.id>-1){this.onCreateSingleGear(r);var _=g.GetRoundGear(i.x,i.y,0);g.GetRoundGear(i.x,i.y,i.lineId>-1?3:1).RestData(1,-1),_.RestData(1,-1),r=1}var f=!1;if(r==v.Blue||r==v.Purple||r==v.Blue2||r==v.Purple2)if(r==n){var p=n+1;(p<v.Blue2&&(r==v.Blue||r==v.Purple)||p<v.Red2&&(r==v.Blue2||r==v.Purple2))&&(n=p,r=1,f=!0)}else this.onCreateSingleGear(r);o&&o.RestData(r),this._crashArr[0].RestData(n),f&&this._crashArr[0].ShowMerge()}g.RemoveCustomGear(t.index),g.RemoveCreateGearMap(t.index),g.IsGuide&&(this._guideId+=1,this.scheduleOnce((function(){e.onStartGuide()}),.2))}else if(1==this._crashArr.length){var y=g.GetRoundGear(t.x,t.y,0),S=this._crashArr[0],T=S.GetGearData();T.gear>v.Gold?(S.RestData(n),y.RestData(T.gear)):T.gear>=C.Unlock&&T.gear<v.Gold&&(S.RestData(n),y.RestData(n>-1?1:-1))}this.onCheckGearTouch()},o.onCheckGearTouch=function(){this._crashArr=[];for(var e=this._copyTs.node,t=this._copyTs.GetGearPos(),n=e.getComponent(h).height/2,o=g.GearMap,a=[],i=0;i<o.length;i++)for(var r=function(){var e=o[i][s],r=e.GetGearData();if(r.gear>-1&&r.gear!=v.Gold&&r.id>0){var d=e.node.getWorldPosition();t.forEach((function(e){u(e.x,e.y).subtract(u(d.x,d.y)).length()<n&&a.push(r.id)}))}},s=0;s<o[i].length;s++)r();for(var d=0;d<o.length;d++)for(var c=0;c<o[d].length;c++){var l=o[d][c],G=l.GetGearData();a.indexOf(G.id)>-1?(l.SetGirdUi(C.Select),this._crashArr.push(l)):l.SetGirdUi()}if(0==this._crashArr.length)for(var _=e.getWorldPosition(),f=g.GearCreateMap,p=0;p<f.length;p++){var y=f[p];if(y&&this._copyTs.GetGearData().uid!=y.node.uuid){y.GetGearData();var S=y.node.getWorldPosition();u(_.x,_.y).subtract(u(S.x,S.y)).length()<n&&this._crashArr.push(y)}}},o.initMap=function(){for(var e=g.GridMap,t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){var o=e[t][n],a=l(this._itemBg);a.setParent(this._nodeBgBox),a.active=!0;var i=a.getComponent(p);g.SetGearMap(i,t,n);var r=n+7*t+1;i.SetData({gear:o,x:n,y:t,id:r}),a.name=r+""}},o.onCreateGear=function(){var e=this;g.GetCustomGear().forEach((function(t,n){t&&e.onCreateSingleGear(t)}))},o.onCreateSingleGear=function(e){var t=g.GetyCreateGearIndex(),n=this.onCreateGearItem({gear:e,id:-1,x:0,y:0,index:t},this._nodeCreateBox);g.SetCreateGearMap(n,t)},o.onCreateGearItem=function(e,t){var n=l(this._itemBg);n.setParent(t),n.active=!0;var o=n.getComponent(p);return o.SetData(e),o},o.SetUiState=function(e){var t=this;G(this._wid).to(.5,{bottom:e?0:-600}).call((function(){g.GameState=e?y.End:y.Start,g.GameState==y.End&&1==g.CustomId?(t._guideId=1,t.onStartGuide()):g.IsGuide=!1,e?t.initGearUi():(s.emit(S.GAME_START),2==g.CustomId&&(t._nodeBtn.active=!0,t.onPlayClickAni()))})).start()},o.onStartGame=function(){for(var e=g.GearMap,t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){e[t][n].StartGame()}},o.onStartGuide=function(){_.stopAllByTarget(this._nodeHand),this._nodeHand.active=!0,g.IsGuide=!0;var e=0,t=[];if(1==this._guideId)e=0,t=[2,2];else if(2==this._guideId)e=1,t=[2,3];else{if(3!=this._guideId){if(4==this._guideId){var n=this._btnStart.getPosition();return n.x+=100,n.y-=20,g.GuideTargetNode=this._btnStart,this._nodeHand.setPosition(n),void G(this._nodeHand).repeatForever(G().to(.2,{scale:c(1,1,1)}).to(.2,{scale:c(.9,.9,.9)}).delay(.2)).start()}return g.IsGuide=!1,void(this._nodeHand.active=!1)}e=0,t=[2,2]}g.GuideTargetNode=this._nodeCreateBox.children[e],g.GuideTagetPos=t;var o=this.onGetCreateGearPos(e),a=this.onGetGearPos(t[0],t[1]);G(this._nodeHand).repeatForever(G().set({position:o,scale:c(1,1,1)}).to(.5,{scale:c(.9,.9,.9)}).to(1,{position:a}).to(0,{scale:c(0,0,0)}).delay(.5)).start()},o.onGetCreateGearPos=function(e){var t=this._nodeCreateBox.children[e],n=t.parent.getComponent(h).convertToWorldSpaceAR(t.getPosition());return n=this._nodeHand.parent.getComponent(h).convertToNodeSpaceAR(n)},o.onGetGearPos=function(e,t){var n=g.GetRoundGear(e,t,0).node,o=n.parent.getComponent(h).convertToWorldSpaceAR(n.getPosition());return o=this._nodeHand.parent.getComponent(h).convertToNodeSpaceAR(o)},o.onShowClick=function(){this._nodeBtn.active=!0},o.onStopMove=function(){g.GearMap.forEach((function(e){e.forEach((function(e){e.InitUi()}))}))},o.initGearUi=function(){g.GearMap.forEach((function(e){e.forEach((function(e){e.InitUi()}))}))},o.onClickStart=function(){if(!g.IsGuide||g.GuideTargetNode.uuid==this._btnStart.uuid){if(g.IsGuide&&(this._guideId+=1,this.onStartGuide()),g.GameState==y.Start)return!1;this.onStartGame(),this.SetUiState(!1)}},o.onClickCreate=function(){g.GetTempNpc()},o.onAllStart=function(){var e=this;g.GearMap.forEach((function(e){e.forEach((function(e){e.StartAniStart()}))})),1==g.CustomId&&this.scheduleOnce((function(){g.NextRound(),e.onCreateGear()}),5)},o.onAllStop=function(){g.GearMap.forEach((function(e){e.forEach((function(e){e.StopAniStop()}))}))},o.onCreateItemParticle=function(e){e&&e.id&&g.GetRoundGearToId(e.id).ShowCreateAni()},o.start=function(){this.onCreateGear()},o.onPlayClickAni=function(){G(this._btnClick).repeatForever(G().to(.1,{scale:c(1.1,1.1,1.1)}).to(.1,{scale:c(1,1,1)})).start()},o.update=function(e){},n}(f))||T);n._RF.pop()}}}));

System.register("chunks:///_virtual/InterfaceTs.ts",["cc"],(function(e){var r;return{setters:[function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"301f1tEjzBOUJR+0BSDExAM","InterfaceTs",void 0);e("GridType",function(e){return e[e.None=-1]="None",e[e.Unlock=0]="Unlock",e[e.Select=1]="Select",e[e.Exist=2]="Exist",e}({})),e("GearType",function(e){return e[e.None=-1]="None",e[e.Gold=100]="Gold",e[e.Blue=101]="Blue",e[e.Purple=102]="Purple",e[e.Blue2=103]="Blue2",e[e.Purple2=104]="Purple2",e[e.Red2=105]="Red2",e}({})),e("GearSpeed",function(e){return e[e.Gold=1]="Gold",e[e.Blue=.03]="Blue",e[e.Purple=.06]="Purple",e[e.Blue2=.08]="Blue2",e[e.Purple2=.16]="Purple2",e[e.Red2=.32]="Red2",e}({})),e("GameStateEnum",function(e){return e[e.None=0]="None",e[e.Start=1]="Start",e[e.End=2]="End",e}({})),e("NpcAniType",function(e){return e.Walk="walk",e.Atk="atk",e.Idle="idle",e.Die="die",e.Skill="skill",e}({})),e("ParticleType",function(e){return e[e.Merge1=0]="Merge1",e[e.Purple=1]="Purple",e[e.Purple2=2]="Purple2",e[e.Red2=3]="Red2",e[e.Blue=4]="Blue",e[e.Blue2=5]="Blue2",e[e.Appear=6]="Appear",e[e.Create=7]="Create",e}({}));r._RF.pop()}}}));

System.register("chunks:///_virtual/ItemGearTs.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Util.ts","./InterfaceTs.ts","./Constant.ts","./NameTs.ts"],(function(e){var t,i,n,a,o,s,r,h,l,d,c,_,u,g,G,m,p,v,f,I,S,y,T,C,k;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e._decorator,a=e.find,o=e.Sprite,s=e.Label,r=e.UITransform,h=e.ParticleSystem,l=e.Node,d=e.director,c=e.UIOpacity,_=e.Tween,u=e.tween,g=e.v3,G=e.v2,m=e.misc,p=e.Component},function(e){v=e.default},function(e){f=e.GameStateEnum,I=e.GearType,S=e.GridType,y=e.GearSpeed,T=e.ParticleType},function(e){C=e.default},function(e){k=e.default}],execute:function(){var N;i._RF.push({},"fbc74RgESdCG6QEK889YlNY","ItemGearTs",void 0);var P=n.ccclass;n.property,e("ItemGearTs",P("ItemGearTs")(N=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this)._imgBg=null,t._imgGear=null,t._imgGear2=null,t._imgNpc=null,t._imgMask=null,t._imgBlack=null,t._imgLine=null,t._labSpeed=null,t._uiTransform=null,t._hand=null,t._particleLine=null,t._gearId=I.None,t._initData=null,t._speedNum=0,t._initAngle=0,t._isTouch=!1,t._isOne=!1,t.isGun=!1,t}t(i,e);var n=i.prototype;return n.onLoad=function(){this.initNode(),this.initEvent()},n.initNode=function(){var e,t,i,n,l,d,c,_,u;this._imgBg=null==(e=a("ImgBg",this.node))?void 0:e.getComponent(o),this._imgGear=null==(t=a("ImgGear",this.node))?void 0:t.getComponent(o),this._imgGear2=null==(i=a("ImgGear2",this.node))?void 0:i.getComponent(o),this._imgNpc=null==(n=a("ImgNpc",this.node))?void 0:n.getComponent(o),this._imgMask=null==(l=a("Mask",this._imgNpc.node))?void 0:l.getComponent(o),this._imgBlack=null==(d=a("NodeBlack",this._imgMask.node))?void 0:d.getComponent(o),this._imgLine=null==(c=a("ImgLine",this.node))?void 0:c.getComponent(o),this._labSpeed=null==(_=a("NodeSpeed/LabSpeed",this.node))?void 0:_.getComponent(s),this._uiTransform=this.node.getComponent(r),this._hand=a("hand",this.node),this._particleLine=null==(u=a("Line",this.node))?void 0:u.getComponent(h)},n.initEvent=function(){this.node.on(l.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(l.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(l.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(l.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this._imgNpc.node.on(l.EventType.TOUCH_END,this.onCreateNpc,this)},n.onTouchStart=function(e){this.onCheckIsNewGuide()&&this._isTouch&&(this.SetGray(!0),this._particleLine.node.active=!1,d.emit(k.GAME_GEAR_TOUCH,this))},n.SetGray=function(e){(this._imgGear.getComponent(c).opacity=e?100:255,this._imgLine.node.active&&(this._imgLine.getComponent(c).opacity=e?100:255),this._imgGear2.node.active&&(this._imgGear2.getComponent(c).opacity=e?100:255),this._labSpeed.node.parent.active&&(this._labSpeed.node.parent.getComponent(c).opacity=e?100:255),this._imgNpc.node.active&&(this._imgNpc.node.getComponent(c).opacity=e?100:255),this._initData.lineId>0)&&v.GetRoundGear(this._initData.x,this._initData.y,3).SetGray(e)},n.onCheckIsNewGuide=function(){var e;return(!v.IsGuide||(null==(e=v.GuideTargetNode)?void 0:e.uuid)===this.node.uuid)&&v.GameState!=f.Start},n.onPlayHandAni=function(e){(v.IsAllClick||v.CustomId>1)&&(e=!1),this._hand.active&&this._gearId==I.Blue2&&(v.AllStop=!1),this._hand.active=e,e&&(_.stopAllByTarget(this._hand),u(this._hand).repeatForever(u().to(.1,{scale:g(1.1,1.1,1.1)}).to(.1,{scale:g(1,1,1)})).start())},n.GetGearData=function(){return v.DeepClone(this._initData)},n.onTouchMove=function(e){if(this.onCheckIsNewGuide()&&this._isTouch){var t=e.touch.getUILocation();d.emit(k.GAME_GEAR_MOVE,t)}},n.onTouchEnd=function(e){this.onCheckIsNewGuide()&&this._isTouch&&(this.SetGray(!1),d.emit(k.GAME_GEAR_END),this._particleLine.node.active=!1)},n.SetData=function(e){this._initData=e,this._gearId=e.gear,this._isTouch=this._gearId>I.Gold,this._initData.id&&(this._initAngle=this._initData.id%2==0?0:22.5),this._imgBlack.fillRange=0,this._particleLine.node.active=!1,this.SetGirdUi(),this.onSetGearUi(e.gear),this.onPlayAni()},n.RestData=function(e,t){void 0===t&&(t=-1);var i=this._initData;i.gear=e,i.lineId=t,this.SetData(i)},n.SetGirdUi=function(e){e||(e=S.None,this._gearId>-1&&this._initData.id>-1&&(e=S.Unlock,this._gearId>=I.Gold&&(e=S.Exist)));var t=-1;switch(e){case S.None:break;case S.Unlock:t=0;break;case S.Select:t=1;break;case S.Exist:t=2}this._imgBg.node.active=t>-1,t>-1&&v.ReplaceUISkin(this._imgBg,C.GirdUrlArr[t])},n.onSetGearUi=function(e){var t=this.onIsDouble(),i=-1;switch(e){case I.Gold:i=0;break;case I.Blue:case I.Blue2:i=1;break;case I.Purple:case I.Purple2:i=2;break;case I.Red2:i=3}this._imgGear.node.active=i>-1,this._imgGear2.node.active=this._imgLine.node.active=!1,this._initData.lineId<1&&t&&(this._imgLine.node.active=!0),this._imgNpc.node.active=(this._initData.lineId<1||!this._initData.lineId)&&this._gearId>I.Gold,this._imgNpc.node.active&&this._gearId>I.Gold&&(v.ReplaceUISkin(this._imgNpc,C.NpcUrl+this._gearId),v.ReplaceUISkin(this._imgMask,C.NpcUrl+this._gearId),this._imgNpc.node.x=this._hand.x=72.5*(this._initData.index>-1||!t?0:-1)),this._initData.index>-1&&t&&(this._imgGear2.node.active=this._imgLine.node.active=!0),this._imgGear.node.angle=this._initAngle,this._imgGear.node.active&&v.ReplaceUISkin(this._imgGear,C.GearUrlArr[i]),this._imgGear2.node.active?(v.ReplaceUISkin(this._imgGear2,C.GearUrlArr[i]),this._imgGear.node.x=-72.5,this._imgGear2.node.x=72.5):this._imgGear.node.x=0,this._imgLine.node.active&&(this._imgLine.node.x=72.5*(this._initData.index>-1?0:-1),v.ReplaceUISkin(this._imgLine,C.GearLineUrl+i)),this._initData.index>-1?this._uiTransform.width=124+(t?174:0):this._uiTransform.width=124},n.onPlayAni=function(){var e=this,t=this.onGetGearSpeed(),i=this._gearId>I.Gold,n=this.onIsDouble();if(this._labSpeed.node.parent.active=i&&(!this._initData.lineId||this._initData.lineId<1),i&&(this._labSpeed.string=t+"/s",this._initData.index>-1?this._labSpeed.node.parent.x=0:this._labSpeed.node.parent.x=72.5*(n&&(!this._initData.lineId||this._initData.lineId<1)?-1:0)),this._imgGear.node.angle=this._initAngle,!(this._initData.id<1)){var a=[0,0,0,0],o=this._initData.x,s=this._initData.y;this._gearId==I.Gold&&u(this._imgGear.node).repeatForever(u().by(y.Gold,{angle:-360},{onUpdate:function(){if(!v.AllStop){var t=e._imgGear.node.angle;t<-75&&!a[0]?(a[0]=1,e.onPlayOtherGear(v.GetRoundGear(o,s,1))):t<-165&&!a[1]?(a[1]=1,e.onPlayOtherGear(v.GetRoundGear(o,s,2))):t<-255&&!a[2]?(a[2]=1,e.onPlayOtherGear(v.GetRoundGear(o,s,3))):t<-345&&!a[3]&&(a[3]=1,e.onPlayOtherGear(v.GetRoundGear(o,s,4)))}}}).call((function(){e._imgGear.node.angle=0,a=[0,0,0,0]}))).start()}},n.onIsDouble=function(){var e=!1;switch(this._gearId){case I.Blue2:case I.Purple2:case I.Red2:e=!0}return e},n.StartAniStart=function(){_.resumeAllByTarget(this._imgGear.node)},n.StopAniStop=function(){_.pauseAllByTarget(this._imgGear.node)},n.onGetGearSpeed=function(){var e=0;switch(this._gearId){case I.Gold:e=y.Gold;break;case I.Blue:e=y.Blue;break;case I.Blue2:e=y.Blue2;break;case I.Purple:e=y.Purple;break;case I.Purple2:e=y.Purple2;break;case I.Red2:e=y.Red2}return e},n.GetIsGold=function(){return this._gearId==I.Gold},n.GetIsEmpty=function(){return this._gearId<I.Gold},n.PlayAngleAni=function(){var e=this;u(this._imgGear.node).by(.1,{angle:45}).call((function(){e._imgGear.node.angle=e._initAngle,e.isGun=!1,v.GameState==f.Start&&e.onPlayMask()})).start(),this.isGun=!0;var t=this._initData.x,i=this._initData.y;this.onPlayOtherGear(v.GetRoundGear(t,i,1)),this.onPlayOtherGear(v.GetRoundGear(t,i,2)),this.onPlayOtherGear(v.GetRoundGear(t,i,3)),this.onPlayOtherGear(v.GetRoundGear(t,i,4))},n.onPlayMask=function(){var e=this;if(this._imgBlack.node.active&&!(this._initData.lineId>-1)){var t=this._imgBlack.fillRange-this.onGetGearSpeed()*C.GearSpeedRate;t<0&&(t=0),u(this._imgBlack).to(.1,{fillRange:t}).call((function(){if(0==t){var i={pos:e._imgNpc.node.getWorldPosition(),atk:50,hp:100,gear:e._gearId,id:e._initData.id};e._gearId!=I.Blue2||1!=v.CustomId||e._isOne||(e._isOne=!0,e.onPlayHandAni(!0),v.AllStop=!0),v.PutTempNpc(i),e._gearId<I.Blue2&&2==v.CustomId&&e.onCreateNpc(),2==v.CustomId&&(v.IsAllClick=!0)}})).start()}},n.onCreateNpc=function(){v.GameState!=f.End&&(v.AllStop&&!this._hand.active||v.GetTempNpc(this._gearId)&&(this._imgBlack.fillRange=1,this.onPlayHandAni(!1),this.ShowCreateAni()))},n.ShowCreateAni=function(){u(this._imgNpc.node).to(.1,{scale:g(1.1,.5,1)}).to(.2,{scale:g(.9,1.1,1)}).to(.1,{scale:g(1,1,1)}).start(),v.ShowParticle(T.Create,null,this._imgNpc.node.getWorldPosition())},n.InitUi=function(){this._imgBlack.fillRange=0,this.onPlayHandAni(!1)},n.GetIsGun=function(){return this.isGun},n.onPlayOtherGear=function(e){e&&(e.GetIsGold()||e.GetIsEmpty()||e.GetIsGun()||e.PlayAngleAni())},n.SetContentSIze=function(e){var t=this._uiTransform.width*e,i=this._uiTransform.height*e;this._uiTransform.setContentSize(t,i)},n.ShowMerge=function(){v.ShowParticle(T.Merge1,this._imgNpc.node.getWorldPosition())},n.GetGearPos=function(){var e=[];return this._imgGear.node.active&&(e[0]=this._imgGear.node.getWorldPosition()),this._imgGear2.node.active&&(e[1]=this._imgGear2.node.getWorldPosition()),e},n.StartGame=function(){this._imgBlack.node.active&&(this._imgBlack.fillRange=1)},n.RemoveGear=function(){this.node.destroy(),this.node.removeFromParent()},n.start=function(){},n.SetLinePos=function(e){for(var t=null,i=-1,n=this._imgNpc.node.getPosition(),a=g(),o=0;o<e.length;o++){var s=e[o].node.getWorldPosition(),h=this._imgNpc.node.parent.getComponent(r).convertToNodeSpaceAR(s),l=h.subtract(n).length();l<400&&(-1==i||l<i)&&(i=l,t=e[o],a=h.clone())}this._particleLine.node.active=!!t,t&&(a.y-=75,this.onShowLine(n,a,i))},n.onShowLine=function(e,t,i){var n=i/180*300,a=e.clone().add(t).multiplyScalar(.5);this._particleLine.node.setPosition(a);var o=v.GetPosAngle(G(a.x,a.y),G(t.x,t.y));this._particleLine.startRotationZ.constant=m.degreesToRadians(o),this._particleLine.node.setScale(n,200,0)},n.getRadianBetweenPoints=function(e,t){var i=t.clone().subtract(e);return Math.atan2(i.x,i.y)},i}(p))||N);i._RF.pop()}}}));

System.register("chunks:///_virtual/load.ts",["./rollupPluginModLoBabelHelpers.js","cc","./audioManager.ts"],(function(e){var n,t,i,r,o,a,c,u,s,l,p,f,d,y,h,b,g;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){c=e.cclegacy,u=e._decorator,s=e.Node,l=e.AudioClip,p=e.resources,f=e.director,d=e.Component,y=e.Prefab,h=e.tween,b=e.v3},function(e){g=e.audioManager}],execute:function(){var m,v,w,T,z,C,x,A,S,D,M;c._RF.push({},"4bb92CXBlhHa6VMX5NgR+XW","load",void 0);var P=u.ccclass,B=u.property;e("load",(m=P("load"),v=B({type:s,displayName:"星星盒子"}),w=B({type:s,displayName:"icon"}),T=B({type:s,displayName:"影子"}),z=B({type:l,displayName:"背景音乐"}),m((A=n((x=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"startBox",A,r(n)),i(n,"icon",S,r(n)),i(n,"yingzi",D,r(n)),i(n,"bgmAudioClip",M,r(n)),n}t(n,e);var c=n.prototype;return c.onLoad=function(){var e=o(a().mark((function e(){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.instance.setAudioSourceClip(this.bgmAudioClip),g.instance.playMusic(),this.startBox.children.forEach((function(e,t){e.on(s.EventType.TOUCH_START,(function(){n.showStar(t)}))})),h(this.icon).repeatForever(h().to(1,{position:b(0,90,0)},{easing:"bounceIn"}).to(1,{position:b(0,0,0)},{easing:"bounceOut"})).start(),h(this.yingzi).repeatForever(h().to(1,{scale:b(.5,.5,.5)}).to(1,{scale:b(1,1,1)})).start(),this.node.on(s.EventType.TOUCH_START,(function(){g.instance.setMusicVolume(1)}),this),e.next=8,this.PreDir("sound",l);case 8:return e.next=10,this.PreDir("effect",y);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.PreDir=function(e,n){return new Promise((function(t,i){p.preloadDir(e,n,(function(e,n){t(null)}))}))},c.onEnable=function(){f.preloadScene("game",(function(e,n){f.loadScene("game")}))},c.showStar=function(e){this.startBox.children.forEach((function(n,t){n.children[0].active=t<=e}))},c.start=function(){g.instance.playMusic()},c.update=function(e){},n}(d)).prototype,"startBox",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=n(x.prototype,"icon",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(x.prototype,"yingzi",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(x.prototype,"bgmAudioClip",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=x))||C));c._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Constant.ts","./CreateGearTs.ts","./EnemyBox.ts","./GameTs.ts","./GearForm.ts","./InterfaceTs.ts","./ItemGearTs.ts","./NameTs.ts","./NpcAniTs.ts","./NpcItem.ts","./ParticleBox.ts","./PlayerBox.ts","./ProgressTs.ts","./UiTs.ts","./Util.ts","./audioManager.ts","./load.ts","./pool.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/NameTs.ts",["cc"],(function(E){var _;return{setters:[function(E){_=E.cclegacy}],execute:function(){_._RF.push({},"a3b31YnqzVFuYztX20cn7tg","NameTs",void 0);var A=E("default",(function(){}));A.GAME_ENEMY_CREATE="GAME_ENEMY_CREATE",A.GAME_ENEMY_DESTORY="GAME_ENEMY_DESTORY",A.GAME_PLAYER_CREATE="GAME_PLAYER_CREATE",A.GAME_PLAYER_DESTORY="GAME_PLAYER_DESTORY",A.GAME_PARTICLE_CREATE="GAME_PARTICLE_CREATE",A.GAME_PARTICLE_DESTORY="GAME_PARTICLE_DESTORY",A.GAME_HP_KOUXUE="GAME_HP_KOUXUE",A.GAME_HP_BOSS="GAME_HP_BOSS",A.GAME_SHOW_CREATE="GAME_SHOW_CREATE",A.GAME_UI_SHOW="GAME_UI_SHOW",A.GAME_UI_CLOSE="GAME_UI_CLOSE",A.GAME_ANI_STOP="GAME_ANI_STOP",A.GAME_ANI_START="GAME_ANI_START",A.GAME_START="GAME_START",A.GAME_END="GAME_End",A.GAME_EXPLOSIVE_BOOM="GAME_EXPLOSIVE_BOOM",A.GAME_GEAR_TOUCH="GAME_GEAR_TOUCH",A.GAME_GEAR_MOVE="GAME_GEAR_MOVE",A.GAME_GEAR_END="GAME_GEAR_END",A.Game_Music_BGM="sound/bgm",A.Game_Music_UPGRADE="sound/upgrade",A.Game_Music_BULLET="sound/bullet",A.Game_Music_GUN="sound/gun",A.Game_Music_CANNON="sound/cannon",A.Game_Music_BOOM="sound/boom",A.Game_Music_Win="sound/win",A.Game_Music_Die="sound/die",A.Game_Music_Fail="sound/fail",A.GAME_VIEW_RESIZE="GAME_VIEW_RESIZE",_._RF.pop()}}}));

System.register("chunks:///_virtual/NpcAniTs.ts",["./rollupPluginModLoBabelHelpers.js","cc","./InterfaceTs.ts","./Util.ts"],(function(n){var t,i,s,e,c,u,a;return{setters:[function(n){t=n.inheritsLoose},function(n){i=n.cclegacy,s=n._decorator,e=n.find,c=n.Component},function(n){u=n.NpcAniType},function(n){a=n.default}],execute:function(){var l;i._RF.push({},"94dddQspVFKfLdXiML1bi+7","NpcAniTs",void 0);var o=s.ccclass;s.property,n("NpcAniTs",o("NpcAniTs")(l=function(n){function i(){for(var t,i=arguments.length,s=new Array(i),e=0;e<i;e++)s[e]=arguments[e];return(t=n.call.apply(n,[this].concat(s))||this)._exhaust=null,t._spineArr=[],t._lastAni=null,t._isRunning=!1,t._call=null,t}t(i,n);var s=i.prototype;return s.onLoad=function(){this.initNode(),this.initEvent()},s.initNode=function(){this._exhaust=e("exhaust",this.node)},s.initEvent=function(){},s.InitSpine=function(n){this._spineArr=n,this._isRunning=!1},s.PlayAni=function(n,t,i){var s=this;void 0===t&&(t=!1),this._isRunning||this._lastAni==n&&t||(this._exhaust&&(this._exhaust.active=n==u.Walk),this._isRunning=!0,this._lastAni=n,this._spineArr.forEach((function(i){i.setAnimation(0,n,t)})),this._call=function(){a.AllStop||(i&&i(),s._isRunning=!1,s._call=null)},this.scheduleOnce(this._call,.5))},s.StopAni=function(){this._spineArr.forEach((function(n){n.timeScale=0})),this.unscheduleAllCallbacks(),this._exhaust&&(this._exhaust.active=!1)},s.StarAni=function(){this._spineArr.forEach((function(n){n.timeScale=1})),this._call&&this.scheduleOnce(this._call,.5),this._exhaust&&(this._exhaust.active=!0)},s.start=function(){},s.update=function(n){},i}(c))||l);i._RF.pop()}}}));

System.register("chunks:///_virtual/NpcItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NameTs.ts","./Util.ts","./NpcAniTs.ts","./InterfaceTs.ts","./Constant.ts"],(function(t){var i,e,n,a,s,o,r,h,l,c,u,p,_,f,S,d,T,g,A,D,v,y,P;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){s=t.cclegacy,o=t._decorator,r=t.CCInteger,h=t.v3,l=t.math,c=t.sp,u=t.director,p=t.tween,_=t.UIOpacity,f=t.v2,S=t.Component},function(t){d=t.default},function(t){T=t.default},function(t){g=t.NpcAniTs},function(t){A=t.GearType,D=t.ParticleType,v=t.NpcAniType,y=t.GameStateEnum},function(t){P=t.default}],execute:function(){var m,E,M,G,I;s._RF.push({},"0a834KJGThJn6fZXOlA5F6q","NpcItem",void 0);var k=o.ccclass,N=o.property;t("NpcItem",(m=k("NpcItem"),E=N({type:r,displayName:"速度"}),m((I=i((G=function(t){function i(){for(var i,e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];return i=t.call.apply(t,[this].concat(s))||this,n(i,"speed",I,a(i)),i._aniTs=null,i._uIOpacity=null,i._initData=null,i._targetPos=null,i.isStart=!1,i.addSpeed=null,i._targetTs=null,i._nodeSpine=null,i}e(i,t);var s=i.prototype;return s.onLoad=function(){this.initNode(),this.initEvent()},s.start=function(){},s.init=function(t){var i=this;this._initData=t,this.node.name=t.isSelf?"self":"enemy";var e=0;if(this._initData.pos1=t.pos1.add(h(0,T.GetRandom(-25,25),0)),this.node.setPosition(this._initData.pos1),this._initData.isSelf){switch(this._initData.gear){case A.Blue:e=0;break;case A.Blue2:e=1;break;case A.Purple:e=2;break;case A.Purple2:e=3;break;case A.Red2:e=5}var n=this.node.getWorldPosition();T.ShowParticle(D.Appear,n)}else e=l.random()>.5?1:0;this.node.children.forEach((function(t,n){if("exhaust"!=t.name&&(t.active=n==e,t.active)){var a=[];t.getComponent(c.Skeleton)?a.push(t.getComponent(c.Skeleton)):t.children.forEach((function(t){a.push(t.getComponent(c.Skeleton))})),i._aniTs.InitSpine(a)}})),this.node.setSiblingIndex(99999-this._initData.index),T.SetEnemyMap(this),this._targetPos=this._initData.pos2,this.isStart=!1,this._uIOpacity.opacity=255,this._aniTs.PlayAni(v.Walk,!0),this.addSpeed=this._initData.pos1.clone().subtract(this._initData.pos2).normalize().multiplyScalar(-this.speed),this.onCheckNpc(),this.onStartMove()},s.onCheckNpc=function(){var t=this;this.schedule((function(){if(!T.AllStop)if(t._targetTs)t._targetTs.GetIsDie()&&(t._targetTs=null,t.isStart=!1,t._targetPos=t._initData.pos2,t._aniTs.PlayAni(v.Walk,!0));else{var i=T.GetEnemyNear(t);i?(t._targetTs=i,t._targetPos=i.node.getPosition()):(t._targetTs=null,t._targetPos=t._initData.pos2,t._aniTs.PlayAni(v.Walk,!0))}}),.1)},s.GetIsSelf=function(){return this._initData.isSelf},s.onEnable=function(){u.on(d.GAME_END,this.onStopMove,this),u.on(d.GAME_START,this.onStartMove,this),u.on(d.GAME_ANI_STOP,this.onStopMove,this),u.on(d.GAME_ANI_START,this.onStartMove,this)},s.onDisable=function(){u.off(d.GAME_END,this.onStopMove,this),u.off(d.GAME_START,this.onStartMove,this),u.off(d.GAME_ANI_STOP,this.onStopMove,this),u.off(d.GAME_ANI_START,this.onStartMove,this)},s.GetIsDie=function(){return!this._initData||this._initData.hp<=0},s.KouXue=function(t){var i=this;void 0===t&&(t=50),this._initData&&(this.GetIsDie()||(this._initData.hp-=t/(this._initData.isSelf?2:1),this.isStart=!0,this._initData.hp<=0&&(this.isStart=!0,this._targetTs=null,this._aniTs.PlayAni(v.Die,!1),p(this._uIOpacity).to(.5,{opacity:0}).call((function(){i.ClearSelf()})).start())))},s.initNode=function(){this._aniTs=this.node.getComponent(g),this._uIOpacity=this.node.getComponent(_)},s.initEvent=function(){},s.onStopMove=function(){this.isStart=!0,this._aniTs.StopAni()},s.onStartMove=function(){this.isStart=!1,this._aniTs.StarAni()},s.hideBack=function(t){this.ClearSelf()},s.ClearSelf=function(){this.isStart=!0,T.RemoveEnemyMap(this),u.emit(this._initData.isSelf?d.GAME_PLAYER_DESTORY:d.GAME_ENEMY_DESTORY,this.node)},s.GetWoldPos=function(){return this.node.getWorldPosition()},s.onStartAtk=function(){var t=this;this.isStart=!0;var i=null;switch(this._initData.gear){case A.Blue:i=D.Blue;break;case A.Red2:i=D.Red2;break;case A.Purple:i=D.Purple;break;case A.Blue2:i=D.Blue2;break;case A.Purple2:i=D.Purple2}i&&T.ShowParticle(i,this.node.getWorldPosition()),this._aniTs.PlayAni(v.Atk,!1,(function(){T.GameState!=y.End&&(t._targetTs&&t._targetTs.KouXue(),t.scheduleOnce((function(){t._targetTs&&!t._targetTs.GetIsDie()?t.onStartAtk():(t._targetTs=null,t.isStart=!1)}),P.AtkCd))}))},s.update=function(t){if(!this.isStart){var i=this.node.getPosition(),e=this.addSpeed.clone().multiplyScalar(t);i=i.add(e),this.node.setPosition(i);var n=f(i.x,i.y).subtract(f(this._targetPos.x,this._targetPos.y)).length();f(i.x,i.y).subtract(f(this._initData.pos2.x,this._initData.pos2.y)).length()<100&&(this.ClearSelf(),this._initData.isSelf?T.GameFinish():u.emit(d.GAME_HP_KOUXUE)),n<100&&this._targetTs&&!this._targetTs.GetIsDie()&&this.onStartAtk()}},i}(S)).prototype,"speed",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 15}}),M=G))||M));s._RF.pop()}}}));

System.register("chunks:///_virtual/ParticleBox.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NameTs.ts","./pool.ts","./InterfaceTs.ts","./Util.ts"],(function(t){var e,i,o,n,r,l,a,c,s,u,p,h,f,P,d,y,m,v,E;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,l=t._decorator,a=t.Node,c=t.find,s=t.director,u=t.instantiate,p=t.ParticleSystem,h=t.UITransform,f=t.v2,P=t.v3,d=t.Component},function(t){y=t.default},function(t){m=t.default},function(t){v=t.ParticleType},function(t){E=t.default}],execute:function(){var x,A,g,T,b;r._RF.push({},"02111kv7gNPuK6APxU0s02F","ParticleBox",void 0);var B=l.ccclass,C=l.property;t("ParticleBox",(x=B("ParticleBox"),A=C([a]),x((b=e((T=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return e=t.call.apply(t,[this].concat(r))||this,o(e,"ParticlePreArr",b,n(e)),e.box=null,e.initPos=null,e.poolMap=new Map,e}i(e,t);var r=e.prototype;return r.onLoad=function(){this.initNode(),this.initEvent(),this.initPool()},r.initNode=function(){this.box=c("box",this.node),this.initPos=c("pos",this.node).getPosition()},r.initEvent=function(){s.on(y.GAME_PARTICLE_CREATE,this.createBullet,this),s.on(y.GAME_PARTICLE_DESTORY,this.clearBullet,this)},r.onDestroy=function(){s.off(y.GAME_PARTICLE_CREATE,this.createBullet,this),s.off(y.GAME_PARTICLE_DESTORY,this.clearBullet,this)},r.initPool=function(){var t=this;this.ParticlePreArr.forEach((function(e){var i=u(e),o=new m(i,10);t.poolMap.set(e.name,o)}))},r.ClearPool=function(){for(var t=this.box.children.length-1;t>=0;)this.clearBullet(this.box.children[0]),t--},r.createBullet=function(t){var e=this,i=this.ParticlePreArr[t.type].name,o=this.poolMap.get(i).createEnemy(this.box);o.getComponent(p).play();var n=null;if(n=t.pos?this.box.getComponent(h).convertToNodeSpaceAR(t.pos):this.initPos.clone(),t.type!=v.Merge1?n.y+=100:n.y+=75,t.startPos){var r=this.box.getComponent(h).convertToNodeSpaceAR(t.startPos);o.setPosition(r);var l=this.getSymmetricalControlPoint(f(r.x,r.y),f(n.x,n.y),E.GetRandom(-500,500));E.bezierTo(o,.2,r,P(l.x,l.y),n).call((function(){t.call&&t.call(),e.clearBullet(o)})).start()}else o.setPosition(n),this.scheduleOnce((function(){t.call&&t.call(),e.clearBullet(o)}),1)},r.getSymmetricalControlPoint=function(t,e,i){var o=t.add(e).multiplyScalar(.5),n=e.subtract(t),r=f(-n.y,n.x).normalize();return o.add(r.multiplyScalar(i))},r.clearBullet=function(t){this.poolMap.get(t.name).onEnemyKilled(t)},r.start=function(){},r.update=function(t){},e}(d)).prototype,"ParticlePreArr",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=T))||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerBox.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NameTs.ts","./pool.ts"],(function(t){var o,i,e,n,l,s,r,a,u,c,h,p,f;return{setters:[function(t){o=t.applyDecoratedDescriptor,i=t.inheritsLoose,e=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){l=t.cclegacy,s=t._decorator,r=t.Node,a=t.find,u=t.director,c=t.instantiate,h=t.Component},function(t){p=t.default},function(t){f=t.default}],execute:function(){var d,_,E,y,P;l._RF.push({},"c9eb7G/9wtKOLHBIYbOOCJW","PlayerBox",void 0);var b=s.ccclass,x=s.property;t("PlayerBox",(d=b("PlayerBox"),_=x({displayName:"预制体",type:r}),d((P=o((y=function(t){function o(){for(var o,i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];return o=t.call.apply(t,[this].concat(l))||this,e(o,"bulletNode",P,n(o)),o.box=null,o._pos1=null,o._pos2=null,o.pool=null,o._pos1W=null,o._index=0,o}i(o,t);var l=o.prototype;return l.onLoad=function(){this.initNode(),this.initEvent(),this.initPool()},l.initNode=function(){this.box=a("box",this.node),this._pos1=a("pos1",this.node).getPosition(),this._pos1W=a("pos1",this.node).getWorldPosition(),this._pos2=a("pos2",this.node).getPosition()},l.initEvent=function(){u.on(p.GAME_PLAYER_CREATE,this.createBullet,this),u.on(p.GAME_PLAYER_DESTORY,this.clearBullet,this),u.on(p.GAME_START,this.onStartGame,this)},l.onDestroy=function(){u.off(p.GAME_PLAYER_CREATE,this.createBullet,this),u.off(p.GAME_PLAYER_DESTORY,this.clearBullet,this)},l.initPool=function(){var t=c(this.bulletNode);this.pool=new f(t,10)},l.onStartGame=function(){},l.ClearPool=function(){for(var t=this.box.children.length-1;t>=0;)this.clearBullet(this.box.children[0]),t--},l.createBullet=function(t){t.pos1=this._pos1.clone(),t.pos2=this._pos2,t.isSelf=!0,this._index+=1,t.index=this._index,this.pool.createEnemy(this.box,t)},l.clearBullet=function(t){this.pool.onEnemyKilled(t)},l.start=function(){},l.update=function(t){},o}(h)).prototype,"bulletNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=y))||E));l._RF.pop()}}}));

System.register("chunks:///_virtual/pool.ts",["cc"],(function(t){var o,e,i;return{setters:[function(t){o=t.cclegacy,e=t.NodePool,i=t.instantiate}],execute:function(){o._RF.push({},"4e9c8a6bLhGBbrWwc8UtJxZ","pool",void 0);t("default",function(){function t(t,o){void 0===o&&(o=10),this.pool=void 0,this.prefab=void 0,t.active=!1,this.prefab=t,this.init(t,o)}var o=t.prototype;return o.init=function(t,o){void 0===o&&(o=10),this.pool=new e;for(var n=0;n<o;n++){var r=i(t);r.active=!1,this.pool.put(r)}},o.createEnemy=function(t,o){void 0===o&&(o={});var e=null;(e=this.pool.size()>0?this.pool.get():i(this.prefab)).parent=t,e.active=!0;var n=e.getComponent(e.name);return n&&n.init&&n.init(o),e},o.onEnemyKilled=function(t){t&&t.name&&(this.prefab&&t.name==this.prefab.name?(t.active=!1,this.pool.put(t)):(t.destroy(),t.removeFromParent(),t=null))},o.clearPool=function(){this.pool.clear()},t}());o._RF.pop()}}}));

System.register("chunks:///_virtual/ProgressTs.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NameTs.ts","./Util.ts"],(function(t){var i,n,e,o,r,s,a,p,u,l,h,c,f,d;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.CCInteger,p=t.ProgressBar,u=t.find,l=t.Label,h=t.director,c=t.Component},function(t){f=t.default},function(t){d=t.default}],execute:function(){var g,_,y,H,b;r._RF.push({},"42411xJPoFHEZqRfEhk+nTu","ProgressTs",void 0);var v=s.ccclass,P=s.property;t("ProgressTs",(g=v("ProgressTs"),_=P({type:a,displayName:"血量"}),g((b=i((H=function(t){function i(){for(var i,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return i=t.call.apply(t,[this].concat(r))||this,e(i,"hp",b,o(i)),i._allHp=0,i._pro=null,i._labHp=null,i}n(i,t);var r=i.prototype;return r.onLoad=function(){this.initNode(),this.initEvent()},r.initNode=function(){this._pro=this.node.getComponent(p),this._labHp=u("Layout/LabHP",this.node).getComponent(l),this._allHp=this.hp},r.initEvent=function(){h.on(f.GAME_HP_KOUXUE,this.onKouXue,this)},r.onKouXue=function(t){void 0===t&&(t=50),this.hp-=t,this._pro.progress=this.hp/this._allHp,this._labHp.string=this.hp.toString(),this._pro.progress=this.hp/this._allHp,this.hp<=0&&d.GameFinish()},r.onEnable=function(){this.onKouXue(0)},r.start=function(){},r.update=function(t){},i}(c)).prototype,"hp",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 500}}),y=H))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/UiTs.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GearForm.ts"],(function(n){var t,o,e,i,r,c;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,i=n.find,r=n.Component},function(n){c=n.GearForm}],execute:function(){var s;o._RF.push({},"1bd472YvrBDLoDTsHGhTuKf","UiTs",void 0);var u=e.ccclass;e.property,n("UiTs",u("UiTs")(s=function(n){function o(){for(var t,o=arguments.length,e=new Array(o),i=0;i<o;i++)e[i]=arguments[i];return(t=n.call.apply(n,[this].concat(e))||this)._mergeFormTs=null,t}t(o,n);var e=o.prototype;return e.onLoad=function(){this.initNode(),this.initEvent()},e.initNode=function(){var n;this._mergeFormTs=null==(n=i("GearForm",this.node))?void 0:n.getComponent(c)},e.initEvent=function(){},e.gameEnd=function(n){},e.SetNoviceNode=function(){},e.onDestroy=function(){},e.downBtn=function(){},e.SetMergeFormUi=function(n){this._mergeFormTs.SetUiState(n)},o}(r))||s);o._RF.pop()}}}));

System.register("chunks:///_virtual/Util.ts",["./rollupPluginModLoBabelHelpers.js","cc","./InterfaceTs.ts","./Constant.ts","./GameTs.ts","./NameTs.ts"],(function(e){var t,n,r,a,i,s,o,u,l,h,c,f,p;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy,r=e.v3,a=e.tween,i=e.Node,s=e.resources,o=e.v2,u=e.screen,l=e.director},function(e){h=e.GameStateEnum},function(e){c=e.default},function(e){f=e.GameTs},function(e){p=e.default}],execute:function(){n._RF.push({},"fa00atWEz9KLJgHieDE3pvK","Util",void 0);var G=window.wx;e("default",new(function(){function e(){this.bulletNum=4,this.isPortrait=null,this.GameState=h.None,this.GridMap=[[-1,-1,-1,-1,-1,-1,-1],[-1,-1,1,1,1,-1,-1],[-1,-1,1,100,1,-1,-1],[-1,-1,1,1,1,-1,-1],[-1,-1,-1,-1,-1,-1,-1]],this.GearMap=[],this.GearCreateMap=[],this.CustomId=1,this.CustomArr=[],this.IsGuide=!1,this.GuideTargetNode=null,this.GuideTagetPos=[],this._enemyMap=[],this._playerMap=[],this._allStop=!1,this.IsAllClick=!1,this._tempList=[],this._isFinish=!1}var n=e.prototype;return n.SetEnemyMap=function(e){(e.GetIsSelf()?this._playerMap:this._enemyMap).push(e)},n.GetEnemyNear=function(e,t){void 0===t&&(t=200);var n=null,r=e.node.getPosition(),a=e.GetIsSelf(),i=a?this._enemyMap:this._playerMap;a&&console.log();for(var s=0;s<i.length;s++){var o=i[s];if(!o.GetIsDie()){var u=o.node.getPosition(),l=r.subtract(u).length();if(l<=t)if(n){if(n.len<l)continue;n={ts:o,len:l}}else n={ts:o,len:l}}}return n&&n.ts},n.RemoveEnemyMap=function(e){var t=e.GetIsSelf()?this._playerMap:this._enemyMap,n=t.findIndex((function(t){return t.node.uuid==e.node.uuid}));n>-1&&t.splice(n,1)},n.RemoveCustomGear=function(e){e<0||(this.CustomArr[e]=null)},n.GetCustomGear=function(e){return void 0===e&&(e=this.CustomId),c.CustomGearArr[e-1]},n.SetGearMap=function(e,t,n){this.GearMap[t]||(this.GearMap[t]=[]),this.GearMap[t][n]=e},n.SetCreateGearMap=function(e,t){this.GearCreateMap[t]=e,this.CustomArr[t]=1},n.RemoveCreateGearMap=function(e){var t=this.GearCreateMap[e];t&&t.RemoveGear(),this.GearCreateMap[e]=null},n.GetyCreateGearIndex=function(){var e=this.GearCreateMap.findIndex((function(e){return!e}));return-1==e&&(e=this.GearCreateMap.length),e},n.GetRoundGear=function(e,t,n){switch(n){case 0:return this.GearMap[t][e];case 1:return e-1>=0?this.GearMap[t][e-1]:null;case 2:return t-1>=0?this.GearMap[t-1][e]:null;case 3:return e+1>6?null:this.GearMap[t][e+1];case 4:return t+1>4?null:this.GearMap[t+1][e]}return null},n.GetRoundGearToId=function(e){for(var t=null,n=0;n<this.GearMap.length;n++)for(var r=0;r<this.GearMap[n].length;r++){var a=this.GearMap[n][r];if(a.GetGearData().id==e){t=a;break}}return t},n.bezierTo=function(e,t,n,i,s,o){o=o||Object.create(null);return o.onUpdate=function(t,a){var o,u,l,h,c,f,p;e.position=(l=i,h=s,c=(1-(o=a))*(1-o)*(u=n).x+2*o*(1-o)*l.x+o*o*h.x,f=(1-o)*(1-o)*u.y+2*o*(1-o)*l.y+o*o*h.y,p=(1-o)*(1-o)*u.z+2*o*(1-o)*l.z+o*o*h.z,r(c,f,p))},a(e).to(t,{},o)},n.changeWorldPos=function(e,t){var n=new i;n.setParent(e),n.setPosition(t);var r=n.getWorldPosition().clone();return n.destroy(),n=null,r},n.LoadResource=function(e,t){return new Promise((function(n,r){s.load(e,t,(function(e,t){n(e?null:t)}))}))},n.ReplaceUISkin=function(e,t){s.load(t+"/spriteFrame",(function(n,r){n?console.log(n.message,t,"err"):r&&(e.spriteFrame=r)}))},n.GetPosAngle=function(e,t){var n=t.x-e.x,r=t.y-e.y;return-(o(n,r).signAngle(o(1,0))/Math.PI*180)},n.getIsPortrait=function(){var e=u.windowSize;return e.width<e.height},n.GetRandom=function(e,t,n){void 0===n&&(n=0);var r=Number(e),a=Number(t),i=Math.random()*(a-r)+r;switch(n){case 0:i=parseInt(i.toString());break;case 1:i=Math.ceil(i);break;case 2:i=Math.floor(i);break;case 3:i=Math.round(i)}return i},n.downGame=function(){},n.GetSameGear=function(e){for(var t=[],n=e.GetGearData().uid,r=e.GetGearData().gear,a=0;a<this.GearMap.length;a++)for(var i=0;i<this.GearMap[a].length;i++){var s=this.GearMap[a][i];s.GetGearData().gear==r&&n!=s.node.uuid&&t.push(s)}for(var o=0;o<this.GearCreateMap.length;o++){var u=this.GearCreateMap[o];if(u)u.GetGearData().gear==r&&n!=u.node.uuid&&t.push(u)}return t},n.ShowParticle=function(e,t,n){l.emit(p.GAME_PARTICLE_CREATE,{pos:t,startPos:n,type:e})},n.PutTempNpc=function(e){this._tempList.push(e)},n.GetTempLen=function(){return this._tempList.length},n.GetTempNpc=function(e){if(void 0===e&&(e=-1),0==this.GetTempLen())return!1;var t=null;if(-1==e)t=this._tempList.shift();else{var n=this._tempList.findIndex((function(t){return t.gear==e}));t=this._tempList.splice(n,1)[0]}return l.emit(p.GAME_PLAYER_CREATE,t),l.emit(p.GAME_SHOW_CREATE,t),!0},n.NextRound=function(){this.CustomId=this.CustomId+1,this.CustomId>2?this.CustomId=2:(this.GameState=h.End,l.emit(p.GAME_END),f.instance.SetMergeFormUi(!0),f.instance.NextRound())},n.DeepClone=function(e,t){var n=this;if(void 0===t&&(t=new WeakMap),null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(Array.isArray(e)){for(var r=[],a=0;a<e.length;a++)r[a]=this.DeepClone(e[a],t);return r}if(e instanceof Map){var i=new Map;return e.forEach((function(e,r){i.set(n.DeepClone(r,t),n.DeepClone(e,t))})),i}if(e instanceof Set){var s=new Set;return e.forEach((function(e){s.add(n.DeepClone(e,t))})),s}if(t.has(e))return t.get(e);var o=Object.create(Object.getPrototypeOf(e));for(var u in t.set(e,o),e)e.hasOwnProperty(u)&&(o[u]=this.DeepClone(e[u],t));return o},n.GameFinish=function(){this._isFinish||(this._isFinish=!0,G&&G.notifyMiniProgramPlayableStatus({isEnd:!0}))},t(e,[{key:"AllStop",get:function(){return this._allStop},set:function(e){this._allStop=e,l.emit(e?p.GAME_ANI_STOP:p.GAME_ANI_START)}}]),e}()));n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});